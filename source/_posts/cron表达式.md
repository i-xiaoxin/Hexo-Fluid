---
title: Cron表达式详解
date: 2022-09-21 18:12:02
tags: 
- Java
- Cron
- Spring
index_img: 
banner_img: /img/article4.webp
categories:
- Java
---

### 前言

<p class="note note-success">
    <b>cron</b>是基于时间的任务管理系统，通过cron在固定时间、日期、间隔下，运行定期任务，如：定期下载文件和邮件。cron该词来源于希腊语chronos（χρόνος），原意是时间。
</p>
通常，任务时间表（crontab）文件储存的指令被crond（守护进程）激活，守护进程在后台运行，并每一分钟检查是否有定期的作业需要执行。这类作业一般称为cron jobs。

### cron表达式格式

```sql
┌───────────── 秒 second (0 - 59)
│ ┌───────────── 分 minute (0 - 59)
│ │ ┌───────────── 时 hour (0 - 23)
│ │ │ ┌───────────── 日 day of the month (1 - 31) or L for last day of the month
│ │ │ │ ┌───────────── 月 month (1 - 12 or Jan/January - Dec/December)
│ │ │ │ │ ┌─────────────周 day of the week (0 - 6 or Sun/Sunday - Sat/Saturday)
│ │ │ │ │ │ ┌─────────────年（一般省略，用不上）
│ │ │ │ │ │ │
* * * * * * * 
```

### cron表达式字符含义

关于 **cron** 的各个域的定义如下表格所示：

|  域  | 是否必填 |   值以及范围    |    通配符     |
| :--: | :------: | :-------------: | :-----------: |
|  秒  |    是    |      0-59       |    , - * /    |
|  分  |    是    |      0-59       |    , - * /    |
|  时  |    是    |      0-23       |    , - * /    |
|  日  |    是    |      1-31       | , - * ? / L W |
|  月  |    是    | 1-12 或 JAN-DEC |    , - * /    |
|  周  |    是    | 1-7 或 SUN-SAT  | , - * ? / L # |
|  年  |    否    |    1970-2099    |    , - * /    |

### cron中的通配符

- `,` 这里指的是在两个以上的时间点中都执行，如果我们在 “分” 这个域中定义为 `8,12,35` ，则表示分别在第8分，第12分 第35分执行该定时任务。
- `-` 这个比较好理解就是指定在某个域的连续范围，如果我们在 “时” 这个域中定义 `1-6`，则表示在1到6点之间每小时都触发一次，用 `,` 表示 `1,2,3,4,5,6`
- `*` 表示所有值，可解读为 “每”。 如果在“日”这个域中设置 `*`,表示每一天都会触发。
- `?` 表示不指定值。使用的场景为不需要关心当前设置这个字段的值。例如:要在每月的8号触发一个操作，但不关心是周几，我们可以这么设置 `0 0 0 8 * ?`
- `/` 在某个域上周期性触发，该符号将其所在域中的表达式分为两个部分，其中第一部分是起始值，除了秒以外都会降低一个单位，比如 在 “秒” 上定义 `5/10` 表示从 第 5 秒开始 每 10 秒执行一次，而在 “分” 上则表示从 第 5 秒开始 每 10 分钟执行一次。
- `L` 表示英文中的**LAST** 的意思，只能在 “日”和“周”中使用。在“日”中设置，表示当月的最后一天(依据当前月份，如果是二月还会依据是否是润年), 在“周”上表示周六，相当于”7”或”SAT”。如果在”L”前加上数字，则表示该数据的最后一个。例如在“周”上设置”7L”这样的格式,则表示“本月最后一个周六”
- `W` 表示离指定日期的最近那个工作日(周一至周五)触发，只能在 “日” 中使用且只能用在具体的数字之后。若在“日”上置”15W”，表示离每月15号最近的那个工作日触发。假如15号正好是周六，则找最近的周五(14号)触发, 如果15号是周未，则找最近的下周一(16号)触发.如果15号正好在工作日(周一至周五)，则就在该天触发。如果是 “1W” 就只能往本月的下一个最近的工作日推不能跨月往上一个月推。
- `#` 表示每月的第几个周几，只能作用于 “周” 上。例如 ”2#3” 表示在每月的第三个周二。

### cron示例

|                          示例 | 说明                                                         |
| ----------------------------: | :----------------------------------------------------------- |
|               `0 15 10 ? * *` | 每天上午10:15执行任务                                        |
|               `0 15 10 * * ?` | 每天上午10:15执行任务                                        |
|                `0 0 12 * * ?` | 每天中午12:00执行任务                                        |
|          `0 0 10,14,16 * * ?` | 每天上午10:00点、下午14:00以及下午16:00执行任务              |
|           `0 0/30 9-17 * * ?` | 每天上午09:00到下午17:00时间段内每隔半小时执行任务           |
|                `0 * 14 * * ?` | 每天下午14:00到下午14:59时间段内每隔1分钟执行任务            |
|              `0 0-5 14 * * ?` | 每天下午14:00到下午14:05时间段内每隔1分钟执行任务            |
|              `0 0/5 14 * * ?` | 每天下午14:00到下午14:55时间段内每隔5分钟执行任务            |
|           `0 0/5 14,18 * * ?` | 每天下午14:00到下午14:55、下午18:00到下午18:55时间段内每隔5分钟执行任务 |
|              `0 0 12 ? * WED` | 每个星期三中午12:00执行任务                                  |
|              `0 15 10 15 * ?` | 每月15日上午10:15执行任务                                    |
|               `0 15 10 L * ?` | 每月最后一日上午10:15执行任务                                |
|              `0 15 10 ? * 6L` | 每月最后一个星期六上午10:15执行任务                          |
|             `0 15 10 ? * 6#3` | 每月第三个星期六上午10:15执行任务                            |
|          `0 10,44 14 ? 3 WED` | 每年3月的每个星期三下午14:10和14:44执行任务                  |
|          `0 15 10 ? * * 2022` | 2022年每天上午10:15执行任务                                  |
|             `0 15 10 ? * * *` | 每年每天上午10:15执行任务                                    |
|      `0 0/5 14,18 * * ? 2022` | 2022年每天下午14:00到下午14:55、下午18:00到下午18:55时间段内每隔5分钟执行任务 |
|   `0 15 10 ? * 6#3 2022,2023` | 2022年至2023年每月第三个星期六上午10:15执行任务              |
| `0 0/30 9-17 * * ? 2022-2025` | 2022年至2025年每天上午09:00到下午17:30时间段内每隔半小时执行任务 |
|   `0 10,44 14 ? 3 WED 2022/2` | 从2022年开始，每隔两年3月的每个星期三下午14:10和14:44执行任务 |

### cron表达式在线工具

1[cron表达式在线工具1](https://www.pppet.net/) 

2[cron表达式在线工具2](https://www.bejson.com/othertools/cron/) 

3[cron表达式在线工具3](https://cron.qqe2.com/) 
